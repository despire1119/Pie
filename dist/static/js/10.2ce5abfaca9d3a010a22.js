webpackJsonp([10],{"7TMs":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("4YfN"),s=a.n(i),n=a("3cXf"),o=a.n(n),l=a("ZLEe"),r=a.n(l),c={name:"AddTag",data(){return{dialogVisible:!1,newTag:"",unionid:this.$route.query.unionid,parentUserid:localStorage.getItem("wxUserid"),userTags:[],listForShow:[],shower:!1,tagObjs:{age_tag:{name:"年龄阶段",list:[{name:"00后"},{name:"90后"},{name:"80后"},{name:"70后"},{name:"60后"},{name:"50后"},{name:"50前"}]},marriage_tag:{name:"婚史",list:[{name:"已婚"},{name:"未婚"},{name:"离异"}]},temperament_tag:{name:"脾气",list:[{name:"好"},{name:"一般"},{name:"不好"}]},distance_tag:{name:"居住距离",list:[{name:"门店500米内"},{name:"门店1公里内"},{name:"门店3公里内"},{name:"门店3公里外"}]},income_tag:{name:"收入情况",list:[{name:"高"},{name:"中"},{name:"低"}]},education_tag:{name:"教育水平",list:[{name:"研究生及以上"},{name:"本科"},{name:"大专"},{name:"职校"},{name:"高中"},{name:"初中"},{name:"小学"},{name:"无学历"}]},profession_tag:{name:"职业",list:[{name:"国企"},{name:"事业单位"},{name:"教师"},{name:"白领"},{name:"家庭主妇"},{name:"个体老板"},{name:"已退休"},{name:"程序员"}]},effect_tag:{name:"社区影响力",list:[{name:"高"},{name:"中"},{name:"低"}]},communicate_tag:{name:"喜欢的沟通方式",list:[{name:"电话"},{name:"短信"},{name:"微信"},{name:"面对面"},{name:"不想沟通"}]},healthcare_tag:{name:"保健偏好",list:[{name:"推拿"},{name:"针灸"},{name:"沐足"},{name:"头疗"},{name:"美容"},{name:"美发"},{name:"皮肤护理"}]},family_tag:{name:"家庭情况",list:[{name:"备孕期"},{name:"新生儿家庭"},{name:"婴幼家庭"},{name:"中大童家庭"},{name:"长者家庭"}]}}}},computed:{listToUpdate(){let e=this.tagObjs,t={};return r()(e).forEach(a=>{e[a].list.forEach(e=>{e.ifCheck&&(t[a]=e.name)}),!t[a]&&(t[a]="")}),t}},mounted(){this.getAllList(),this.getInitialTags()},methods:{getInitialTags(){const e=JSON.parse(this.$route.query.tags);let t=this.tagObjs;r()(t).forEach(a=>{r()(e).forEach(i=>{a===i&&e[i]&&t[a].list.forEach(t=>{t.name===e[i]&&(t.ifCheck=!0)})})}),this.tagObjs=JSON.parse(o()(t))},centerControl(){this.shower=!this.shower,console.log(this.shower)},listControl(e){let t=this.tagObjs;t[e].ifCheck=!t[e].ifCheck,this.tagObjs=JSON.parse(o()(t))},checkTags(e,t){let a=this.tagObjs;a[e].list.forEach((e,a)=>{e.ifCheck=t===a&&!e.ifCheck}),this.tagObjs=JSON.parse(o()(a))},getAllList(){this.$axios.all([this.getTags(),this.getUserTags()]).then(this.$axios.spread((e,t)=>{this.userTags=t.data.dataList;let a=e.data.dataList;a.forEach(e=>{this.userTags.forEach(t=>{e.id===t.tagID&&(e.ifCheck=!0)})}),this.listForShow=JSON.parse(o()(a))}))},deleteTag(e){this.$axios.post("/tag/delete",{id:e},{headers:{"x-s-userid":this.parentUserid}}).then(e=>{console.log(e),"success"===e.data.desc&&this.getAllList()})},chooseTag(e){let t=this.listForShow;t.forEach((t,a)=>{e===a&&(t.ifCheck=!t.ifCheck,console.log(t))}),this.listForShow=JSON.parse(o()(t))},pressBtn(e,t){return()=>{this.$nextTick(()=>{let t=this.listForShow;t.forEach((t,a)=>{a===e&&(t.deleteShow=!t.deleteShow,console.log(t.deleteShow))}),this.listForShow=JSON.parse(o()(t))})}},addCancel(){this.newTag="",this.dialogVisible=!1},addConfirm(){this.$axios.post("/tag/add",{unionid:this.unionid,tagName:this.newTag},{headers:{"x-s-userid":this.parentUserid}}).then(e=>{"success"===e.data.desc&&(this.newTag="",this.dialogVisible=!1,this.getAllList())})},clearAdd(){let e=[];return this.listForShow.forEach(t=>{t.ifCheck&&e.push(t.id)}),this.$axios.post("userTag/clearAndAdd",{unionid:this.unionid,tagIDList:e},{headers:{"x-s-userid":this.parentUserid}})},updateTag(){return this.$axios.post("/user/updateTag",s()({unionid:this.unionid},this.listToUpdate),{headers:{"x-s-userid":this.parentUserid}})},addTagsConfirm(){this.$axios.all([this.clearAdd(),this.updateTag()]).then(this.$axios.spread((e,t)=>{"000000"===e.data.resultCode&&"000000"===t.data.resultCode&&window.history.go(-1)}))},getTags(){return this.$axios.post("/tag/list",null,{headers:{"x-s-userid":this.parentUserid}})},getUserTags(){return this.$axios.post("/userTag/list",{unionid:this.unionid},{headers:{"x-s-userid":this.parentUserid}})},handleClose(e){this.dialogVisible=!1}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"with-bottom"},[a("div",{staticClass:"tag-panel"},[a("p",{staticClass:"tag-name",on:{click:function(t){e.centerControl()}}},[a("span",[e._v("自定义标签")]),e._v(" "),a("span",{staticClass:"btn-left"},[e._v("\n        "+e._s(e.shower?"收起":"更多")+"\n        "),a("i",{class:e.shower?"el-icon-arrow-up":"el-icon-arrow-down"})])]),e._v(" "),e.shower?a("div",{staticClass:"tags"},[a("el-button",{staticClass:"tag-cell adder",attrs:{type:"text",plain:""},on:{click:function(t){e.dialogVisible=!0}}},[e._v("+")]),e._v(" "),e._l(e.listForShow,function(t,i){return a("span",{directives:[{name:"longpress",rawName:"v-longpress",value:e.pressBtn(i,t.id),expression:"pressBtn(index, item.id)"}],key:i,staticClass:"tag-cell",class:{active:t.ifCheck},on:{click:function(t){e.chooseTag(i)}}},[e._v("\n        "+e._s(t.tagName)+"\n        "),a("i",{directives:[{name:"show",rawName:"v-show",value:t.deleteShow,expression:"item.deleteShow"}],staticClass:"tag-delete el-icon-error",on:{click:function(a){e.deleteTag(t.id)}}})])})],2):e._e()]),e._v(" "),e._l(e.tagObjs,function(t,i){return a("div",{key:i,staticClass:"tag-panel"},[a("p",{staticClass:"tag-name",on:{click:function(t){e.listControl(i)}}},[a("span",[e._v(e._s(t.name))]),e._v(" "),a("span",{staticClass:"btn-left"},[e._v("\n        "+e._s(t.ifCheck?"收起":"更多")+"\n        "),a("i",{class:t.ifCheck?"el-icon-arrow-up":"el-icon-arrow-down"})])]),e._v(" "),t.ifCheck?a("div",{staticClass:"tags"},e._l(t.list,function(t,s){return a("span",{key:s,staticClass:"tag-cell",class:{active:t.ifCheck},on:{click:function(t){e.checkTags(i,s)}}},[e._v(e._s(t.name))])}),0):e._e()])}),e._v(" "),a("div",{staticClass:"btn-bottom"},[a("button",{on:{click:function(t){e.addTagsConfirm()}}},[e._v("确定")])]),e._v(" "),a("el-dialog",{attrs:{title:"自定义标签",visible:e.dialogVisible,width:"65%","before-close":e.handleClose,"show-close":!1,center:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"tag-contain"},[a("el-input",{attrs:{placeholder:"请输入会员标签"},model:{value:e.newTag,callback:function(t){e.newTag=t},expression:"newTag"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.addCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.addConfirm}},[e._v("确 定")])],1)])],2)},staticRenderFns:[]};var g=a("C7Lr")(c,d,!1,function(e){a("o/6G")},"data-v-3fcbeb62",null);t.default=g.exports},"i+Gx":function(e,t,a){(e.exports=a("UTlt")(!1)).push([e.i,'.tit[data-v-3fcbeb62]{background-color:#f2dac1;line-height:10.667vw;text-indent:4vw;font-size:3.733vw;color:#333;content:"viewport-units-buggyfill; line-height: 10.667vw; text-indent: 4vw; font-size: 3.733vw"}.with-bottom[data-v-3fcbeb62]{margin-bottom:20.8vw;content:"viewport-units-buggyfill; margin-bottom: 20.8vw"}.tag-panel[data-v-3fcbeb62]{background-color:#fff}.tag-panel .line[data-v-3fcbeb62]{display:inline-block;width:.533vw;height:4vw;margin-left:4vw;margin-right:1.867vw;border-radius:.267vw;background-image:linear-gradient(45deg,#95ce4e 1%,#8ac83a);content:"viewport-units-buggyfill; width: 0.533vw; height: 4vw; margin-left: 4vw; margin-right: 1.867vw; border-radius: 0.267vw"}.tag-panel .tag-name[data-v-3fcbeb62]{display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:12vw;padding:0 4.533vw;font-size:3.733vw;color:#5c5c5c;border-bottom:1px solid #f2f2f2;content:"viewport-units-buggyfill; height: 12vw; padding: 0 4.533vw; font-size: 3.733vw"}.tag-panel .tag-name .btn-left[data-v-3fcbeb62]{font-size:3.2vw;color:#868686;content:"viewport-units-buggyfill; font-size: 3.2vw"}.tag-panel .tags[data-v-3fcbeb62]{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:3.6vw 1.067vw 0;margin-bottom:3.6vw;border-bottom:1px solid #eef0f3;content:"viewport-units-buggyfill; padding: 3.6vw 1.067vw 0; margin-bottom: 3.6vw"}.tag-panel .tags .tag-cell[data-v-3fcbeb62],.tag-panel .tags[data-v-3fcbeb62]{display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.tag-panel .tags .tag-cell[data-v-3fcbeb62]{position:relative;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border:1px solid #e3e3e3;font-size:3.467vw;margin:0 2.933vw;margin-bottom:3.733vw;padding:2vw 2.667vw;min-width:26.667vw;height:7.467vw;border-radius:.533vw;text-align:center;color:#5c5c5c;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;content:"viewport-units-buggyfill; font-size: 3.467vw; margin: 0 2.933vw; margin-bottom: 3.733vw; padding: 2vw 2.667vw; min-width: 26.667vw; height: 7.467vw; border-radius: 0.533vw"}.tag-panel .tags .tag-cell .tag-delete[data-v-3fcbeb62]{position:absolute;right:-2.4vw;top:-2.667vw;font-size:6vw;background-color:#fff;border-radius:4.533vw;color:#d5d5d5;content:"viewport-units-buggyfill; right: -2.4vw; top: -2.667vw; font-size: 6vw; border-radius: 4.533vw"}.tag-panel .tags .active[data-v-3fcbeb62]{background-color:rgba(138,200,58,.4);color:#81bb36;border-color:#81bb36}.tag-contain input[data-v-3fcbeb62]{height:8vw;line-height:8vw;content:"viewport-units-buggyfill; height: 8vw; line-height: 8vw"}.btn-bottom[data-v-3fcbeb62]{display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:fixed;bottom:0;left:0;right:0;height:16.533vw;background-color:#fff;border-top:1px solid #f2f2f2;content:"viewport-units-buggyfill; height: 16.533vw"}.btn-bottom button[data-v-3fcbeb62]{width:77.333vw;height:9.333vw;background-color:#8ac83a;color:#fff;border-radius:.8vw;content:"viewport-units-buggyfill; width: 77.333vw; height: 9.333vw; border-radius: 0.8vw"}',""])},"o/6G":function(e,t,a){var i=a("i+Gx");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("FIqI")("69a1dd08",i,!0,{})}});